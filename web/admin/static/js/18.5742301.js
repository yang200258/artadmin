(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{DgvE:function(t,e,a){"use strict";var n={delIdArray:function(t,e){for(var a=0;a<t.length;a++)t[a].id==e&&t.splice(a,1);console.log("this.arr",t)},filterDate:function(t){return t?t.getFullYear()+"-"+(t.getMonth()+1>=10?t.getMonth()+1:"0"+(t.getMonth()+1))+"-"+(t.getDate()>=10?t.getDate():"0"+t.getDate()):""},filterDateTime:function(t){return t?t.getFullYear()+"-"+(t.getMonth()+1>=10?t.getMonth()+1:"0"+(t.getMonth()+1))+"-"+(t.getDate()>=10?t.getDate():"0"+t.getDate())+" "+(t.getHours()>=10?t.getHours():"0"+t.getHours())+":"+(t.getMinutes()>=10?t.getMinutes():"0"+t.getMinutes())+":"+(t.getSeconds()>=10?t.getSeconds():"0"+t.getSeconds()):""}};e.a=n},OuHl:function(t,e,a){"use strict";var n=a("gugX");a.n(n).a},aTPv:function(t,e,a){"use strict";a.r(e);var n,i=a("DgvE");function o(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var l={data:function(){return{category:[],categoryname:"",innerVisible:!1,inputVisible:!1,editcategary:{},dialogVisible:!1,infoTypeOptions:[],type:"",status:"",infoStatusOptions:[{value:"1",label:"已发布"},{value:"2",label:"草稿"}],publishDate:[],pageSize:0,totalNumber:0,infoData:[],currentPage:1,head:[{key:"id",name:"信息编号"},{key:"infoType",name:"信息分类"},{key:"title",name:"标题"},{key:"cover_url",name:"封面图"},{key:"status",name:"状态"},{key:"create_at",name:"发布时间"}],loadingTable:!1,title:"",count:99,addcategoryname:"",deleteid:[]}},mounted:function(){this.getTypeList()},methods:(n={addCategory:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this,e=this.addcategoryname;e&&this.$axios({url:"/msg/category/add",method:"post",data:{name:e}}).then(function(a){console.log("添加信息分类响应",a),a&&!a.error&&(t.getTypeList(),t.category.push({id:t.count++,name:e}),t.inputVisible=!1,t.addcategoryname="")}).catch(function(t){console.log(t)}),this.inputVisible=!1},closeTag:function(t){var e=this;console.log(t),this.$axios({url:"/msg/category/delete",method:"post",data:{id:t}}).then(function(a){console.log(a),a&&!a.error?i.a.delIdArray(e.category,t):alert(a.msg)}).catch(function(t){console.log(t)})},editCategaryName:function(t){var e=this;this.innerVisible=!0,this.editcategary=t,this.$nextTick(function(){e.$refs.editTagInput.$refs.input.focus()})},editCategary:function(){var t=this;this.$axios({url:"/msg/category/edit",method:"post",data:this.editcategary}).then(function(e){console.log("编辑分类信息响应",e),e&&!e.error&&(t.innerVisible=!1)}).catch(function(t){console.log(t)})},handleSizeChange:function(t){console.log("每页 "+t+" 条")},handleCurrentChange:function(t){console.log("当前页: "+t)},queryInfoData:function(t){var e=this,a=this.title,n=this.status,o=this.publishDate,l=this.type;this.loadingTable=!0,t=t||1;var s=i.a.filterDate(o[0]),r=i.a.filterDate(o[1]);this.$axios({url:"/msg/list",method:"post",data:{cid:l,title:a,status:n,start_time:s,end_time:r,pn:t}}).then(function(t){console.log("查询信息列表数据",t),t&&!t.error&&(t.data.list.forEach(function(t){t.status=(t.status=1)?"已发布":"草稿",e.infoTypeOptions.forEach(function(e){e.id==t.cid&&(t.infoType=e.name)})}),e.infoData=t.data.list,e.totalNumber=t.data.page.total,e.pageSize=t.data.page.limit,e.currentPage=t.data.page.pn,e.is_end=t.data.page.is_end),e.loadingTable=!1}).catch(function(t){e.loadingTable=!1,console.log(t)})},editOption:function(){var t=this;this.dialogVisible=!0,this.$axios({url:"/msg/category/list",method:"post",data:{}}).then(function(e){console.log("信息分类数据",e),e&&!e.error&&(t.category=e.data)}).catch(function(t){console.log(t)})},deleteOption:function(){var t=this;this.$axios({url:"/msg/delete",method:"post",data:{id:this.deleteid}}).then(function(e){e&&!e.error&&t.queryInfoData(),t.deleteid=[]}).catch(function(e){console.log(e),t.deleteid=[]})},editInfo:function(t){this.$router.push({name:"editInfo",params:{id:t.row.id,url:t.row.cover_url}})},deleteInfo:function(t){var e=this,a=t.row.id;this.$axios({url:"/msg/delete",method:"post",data:{id:[a]}}).then(function(t){t&&!t.error&&e.queryInfoData()}).catch(function(t){console.log(t)})},getTypeList:function(){var t=this;this.$axios({url:"/msg/category/list",method:"post",data:{}}).then(function(e){console.log("获取到的信息分类列表",e),e&&!e.error&&t.$set(t,"infoTypeOptions",e.data)}).catch(function(t){console.log(t)})},handleClose:function(){this.dialogVisible=!1}},o(n,"handleCurrentChange",function(t){this.queryInfoData(t)}),o(n,"handleSelectionChange",function(t){var e=this;t.forEach(function(t){e.deleteid.push(t.id)}),console.log(t)}),o(n,"getRowKey",function(t){return t.id}),n)},s=(a("OuHl"),a("KHd+")),r=Object(s.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"header"},[a("el-row",{attrs:{gutter:40}},[a("el-col",{staticClass:"infoType",attrs:{span:4}},[a("p",[t._v("信息分类：")]),t._v(" "),a("el-select",{attrs:{placeholder:"全部"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.infoTypeOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-col",{staticClass:"title",attrs:{span:4}},[a("p",[t._v("标题：")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),a("el-col",{staticClass:"infoStatus",attrs:{span:4}},[a("p",[t._v("状态：")]),t._v(" "),a("el-select",{attrs:{placeholder:"全部"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.infoStatusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:8}},[a("p",[t._v("发布日期：")]),t._v(" "),a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.publishDate,callback:function(e){t.publishDate=e},expression:"publishDate"}})],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:function(e){return e.preventDefault(),t.queryInfoData(e)}}},[t._v("查询")])],1)],1)],1),t._v(" "),a("table-data",{attrs:{head:t.head,isPagination:"true",currentPage:t.currentPage,pageSize:t.pageSize,totalNumber:t.totalNumber,isEdit:"true",isDelete:"'true'",isSelected:"'true'",loadingTable:t.loadingTable,tableData:t.infoData,editName:"信息分类管理",deleteName:"删除",isOption:"true",isEditTable:"true",editTableName:"编辑",isDeleteTable:"true",deleteTableName:"删除"},on:{handleCurrentChange:t.handleCurrentChange,editInfo:t.editInfo,deleteInfo:t.deleteInfo,editOption:t.editOption,deleteOption:t.deleteOption,handleSelectionChange:t.handleSelectionChange,getRowKey:t.getRowKey}}),t._v(" "),a("el-dialog",{attrs:{title:"分类管理",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[t._l(t.category,function(e){return a("el-tag",{key:e.id,ref:"categaryName",refInFor:!0,staticClass:"category-container",attrs:{closable:""},on:{close:function(a){t.closeTag(e.id)}}},[a("span",[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"el-icon-edit",on:{click:function(a){t.editCategaryName(e)}}})])}),t._v(" "),t.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.addcategoryname,callback:function(e){t.addcategoryname=e},expression:"addcategoryname"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.addCategory}},[t._v("添加分类")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确 定")])],1),t._v(" "),a("el-dialog",{attrs:{width:"30%",title:"编辑",visible:t.innerVisible,"append-to-body":""},on:{"update:visible":function(e){t.innerVisible=e}}},[a("el-input",{ref:"editTagInput",staticClass:"input-new-tag",attrs:{size:"small"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.editCategary(e):null}},model:{value:t.editcategary.name,callback:function(e){t.$set(t.editcategary,"name",e)},expression:"editcategary.name"}})],1)],2)],1)},[],!1,null,"fbcb4754",null);e.default=r.exports},gugX:function(t,e,a){}}]);